document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add("loaded");const e=document.getElementById("current-year");e&&(e.textContent=(new Date).getFullYear());const t=document.querySelector(".logo");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"}),history.pushState(null,null,"/")});const o=document.querySelector(".site-header");if(o){const e=()=>{o.classList.toggle("scrolled",window.scrollY>0)};window.addEventListener("scroll",e),e()}initVideoPlaceholders(),document.querySelectorAll(".toggle").forEach(e=>{e.addEventListener("click",()=>{const t="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",String(!t)),e.nextElementSibling.hidden=t})})});const navToggle=document.querySelector(".nav-toggle"),navList=document.querySelector(".nav-list"),navLinks=document.querySelectorAll(".nav-list a");if(navToggle&&navList&&(navToggle.addEventListener("click",()=>{const e=navList.classList.toggle("active");navToggle.classList.toggle("active",e),document.body.classList.toggle("nav-open",e),navToggle.textContent=e?"✖️":"☰",navToggle.setAttribute("aria-expanded",e)}),navToggle.setAttribute("aria-expanded","false"),navLinks.forEach(e=>{e.addEventListener("click",()=>{navList.classList.contains("active")&&(navList.classList.remove("active"),navToggle.classList.remove("active"),document.body.classList.remove("nav-open"),navToggle.textContent="☰",navToggle.setAttribute("aria-expanded",!1))})})),document.querySelectorAll(".bio-toggle").forEach(e=>{const t=e.closest(".bio-card");t.querySelector(".bio-content");e.addEventListener("click",()=>{const o=t.classList.toggle("expanded");e.setAttribute("aria-expanded",o),e.textContent=o?"Show Less":"Read More"})}),navLinks.length>0){const e=Array.from(navLinks).map(e=>document.querySelector(e.hash)).filter(Boolean),t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.id;navLinks.forEach(e=>{e.classList.toggle("active",e.hash===`#${t}`)})}})},{threshold:.25});e.forEach(e=>t.observe(e))}function initVideoPlaceholders(){document.querySelectorAll(".video-wrapper").forEach(e=>{const t=e.querySelector("img"),o=e.querySelector(".play-button");if(!t||!o)return;const n=e.dataset.title;if(n){const t=document.createElement("div");t.className="video-title",t.textContent=n,e.appendChild(t)}const i=()=>{const o=t.naturalWidth/t.naturalHeight;o&&e.style.setProperty("--ratio",o)};t.complete?i():t.addEventListener("load",i),o.addEventListener("click",t=>{t.preventDefault(),openModal(e)}),e.addEventListener("mouseenter",()=>showPreview(e)),e.addEventListener("mouseleave",()=>hidePreview(e))})}function openModal(e){hidePreview(e);const t=document.getElementById("video-modal"),o=t.querySelector(".modal-video-container"),n=`${e.dataset.src}?autoplay=1`,i=parseFloat(e.style.getPropertyValue("--ratio"))||16/9,r=.9*window.innerWidth,a=.9*window.innerHeight;let l=r,d=l/i;d>a&&(d=a,l=d*i),o.style.width=`${l}px`,o.style.height=`${d}px`,o.style.setProperty("--modal-ratio",i),o.innerHTML=`<iframe src="${n}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen tabindex="0" title="Video player"></iframe>`,t.hidden=!1,document.body.style.overflow="hidden";const s=o.querySelector("iframe");s&&s.focus();const c=()=>{const e=.9*window.innerWidth,t=.9*window.innerHeight;let n=e,r=n/i;r>t&&(r=t,n=r*i),o.style.width=`${n}px`,o.style.height=`${r}px`};window.addEventListener("resize",c),o._resizeHandler=c}function closeModal(){const e=document.getElementById("video-modal"),t=e.querySelector(".modal-video-container");e.hidden=!0,t.innerHTML="",t.style.width="",t.style.height="";const o=t._resizeHandler;o&&(window.removeEventListener("resize",o),delete t._resizeHandler),document.body.style.overflow=""}function getPreviewSrc(e){if(!e)return"";if(e.includes("youtube")){const t=e.match(/embed\/(.*?)(\?|$)/),o=t?t[1]:"";return o?`https://www.youtube.com/embed/${o}?autoplay=1&mute=1&controls=0&loop=1&start=0&end=2&playlist=${o}`:""}return e.includes("vimeo")?`${e}?autoplay=1&muted=1&loop=1#t=0,2`:""}function showPreview(e){const t=getPreviewSrc(e.dataset.src);if(!t)return;let o=e.querySelector(".preview-iframe");o||(o=document.createElement("iframe"),o.className="preview-iframe",o.setAttribute("aria-hidden","true"),o.setAttribute("tabindex","-1"),o.allow="autoplay; muted",e.appendChild(o)),o.src=t}function hidePreview(e){const t=e.querySelector(".preview-iframe");t&&t.remove()}document.querySelector("#video-modal .modal-close").addEventListener("click",closeModal),document.getElementById("video-modal").addEventListener("click",function(e){e.target===this&&closeModal()}),document.querySelector("#video-modal .modal-content").addEventListener("click",e=>e.stopPropagation()),document.addEventListener("keydown",e=>{"Escape"===e.key&&closeModal()});